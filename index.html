<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Redirecting...</title>
<script>
  const params = new URLSearchParams(window.location.search);
  
  const shortcut = params.get('name'); // ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå
  const file = params.get('file');     // Obsidianãƒ•ã‚¡ã‚¤ãƒ«å
  const vault = params.get('vault');   // Obsidianä¿ç®¡åº«å
  const openApp = params.get('open');  // ã‚¢ãƒ—ãƒªèµ·å‹•ã®ã¿ç”¨

  // 1. ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆèµ·å‹•
  if (shortcut) {
    window.location.href = 'shortcuts://run-shortcut?name=' + encodeURIComponent(shortcut);
    document.body.innerHTML = "<h1>ğŸš€ ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ: " + shortcut + " ã‚’èµ·å‹•ä¸­...</h1>";
  } 
  // 2. Obsidianèµ·å‹• (ãƒ•ã‚¡ã‚¤ãƒ«ã€ä¿ç®¡åº«ã€ã¾ãŸã¯ ?open=1 ãŒã‚ã‚‹å ´åˆ)
  else if (file || vault || openApp) {
    let uri = 'obsidian://open';
    let queries = [];

    if (vault) queries.push('vault=' + encodeURIComponent(vault));
    if (file)  queries.push('file=' + encodeURIComponent(file));

    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã®ã¿ ? ã‚’ã¤ã‘ã¦é€£çµ
    if (queries.length > 0) {
      uri += '?' + queries.join('&');
    }

    window.location.href = uri;
    document.body.innerHTML = "<h1>ğŸ’ Obsidianã‚’èµ·å‹•ã—ã¦ã„ã¾ã™...</h1>";
  }
  // 3. ä½•ã‚‚æŒ‡å®šãŒãªã„å ´åˆ
  else {
    document.body.innerHTML = "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>?name=ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå<br>?file=ãƒãƒ¼ãƒˆå<br>?open=1 (ã‚¢ãƒ—ãƒªèµ·å‹•ã®ã¿)";
  }
  settimeout(function() {
    window.close();
  }, 5000);
</script>
</head>
<body></body>
</html>
