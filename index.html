<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Redirecting...</title>
<style>
  /* 1. å…¨ä½“ã‚’ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹ */
  body {
    background-color: #111; /* èƒŒæ™¯ã¯é»’ */
    color: #666;            /* æ–‡å­—ã¯æš—ã„ã‚°ãƒ¬ãƒ¼ */
    font-family: sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    text-align: center;
  }
  h1 { font-size: 1.2rem; font-weight: normal; }

  /* 2. Ã—ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰ */
  .close-button {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 44px;  /* ã‚¿ãƒƒãƒ—ã—ã‚„ã™ã„ã‚µã‚¤ã‚º */
    height: 44px;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #333; /* ãƒœã‚¿ãƒ³ã®è‰²ï¼šæ¿ƒã„ã‚°ãƒ¬ãƒ¼ */
    color: #fff;            /* ãƒãƒ„å°ã®è‰²ï¼šç™½ */
    transition: all 0.2s ease;
    -webkit-tap-highlight-color: transparent; /* ã‚¿ãƒƒãƒ—æ™‚ã®æ ç·šã‚’æ¶ˆã™ */
  }
  .close-button:active {
    transform: scale(0.9);
    background-color: #555;
  }
</style>
<script>
  const params = new URLSearchParams(window.location.search);
  
  const shortcut = params.get('name');
  const file = params.get('file');
  const vault = params.get('vault');
  const openApp = params.get('open');

  // èµ·å‹•å‡¦ç†
  function launch() {
    let uri = '';
    let msg = '';

    if (shortcut) {
      uri = 'shortcuts://run-shortcut?name=' + encodeURIComponent(shortcut);
      msg = "ğŸš€ " + shortcut;
    } else if (file || vault || openApp) {
      uri = 'obsidian://open';
      let queries = [];
      if (vault) queries.push('vault=' + encodeURIComponent(vault));
      if (file)  queries.push('file=' + encodeURIComponent(file));
      if (queries.length > 0) uri += '?' + queries.join('&');
      msg = "ğŸ’ Obsidian";
    }

    if (uri) {
      document.getElementById('status').innerHTML = "<h1>" + msg + " ã‚’èµ·å‹•ä¸­...</h1>";
      window.location.href = uri;
      
      // è‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚ºï¼ˆå¿µã®ãŸã‚ï¼‰
      setTimeout(() => { window.close(); }, 3000);
    } else {
      document.getElementById('status').innerHTML = "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼<br><small>?name=... ã¾ãŸã¯ ?file=...</small>";
    }
  }

  window.onload = launch;
</script>
</head>
<body>
  <div id="status">Loading...</div>

  <button class="close-button" onclick="window.close()" aria-label="Close">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
      <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/>
    </svg>
  </button>
</body>
</html>
